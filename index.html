<!doctype html>
<html lang="fa">
  <head>
    <meta charset="UTF-8" />
    <title>ورود | هاویرکشت</title>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
      body {
        font-family: "Tahoma", sans-serif;
        direction: rtl;
        margin: 0;
        padding: 0;
        background: #f2f4f7; /* پس‌زمینه روشن خنثی */
      }

      header,
      footer {
        background: #0f3149; /* رنگ سرمه‌ای اصلی */
        height: 50px;
        width: 100%;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
      }

      header {
        position: fixed;
        top: 0;
        left: 0;
        z-index: 1000;
      }

      footer {
        position: fixed;
        bottom: 0;
        left: 0;
        text-align: center;
        color: #fff;
        line-height: 50px;
        font-size: 14px;
      }

      .table-box {
        width: 420px;
        margin: 120px auto 100px auto;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 12px 25px rgba(0, 0, 0, 0.25);
        background: #ffffff;
        border: 1px solid #0c3552; /* سرمه‌ای تیره برای فرم */
      }

      .table-header {
        padding: 20px;
        text-align: center;
        background: #f9f9f9;
      }

      .table-header img {
        height: 60px;
        margin: 0 15px;
      }

      .table-body {
        padding: 30px 25px;
        text-align: center;
      }

      .table-body h3 {
        margin-bottom: 25px;
        color: #0f3149;
        font-size: 22px;
        font-weight: bold;
      }

      input {
        width: 100%;
        padding: 12px 10px;
        margin-top: 12px;
        border-radius: 6px;
        border: 1px solid #b0b0b0;
        font-size: 14px;
        transition: all 0.3s ease;
      }

      input:focus {
        outline: none;
        border-color: #0f3149; /* رنگ سرمه‌ای برای focus */
        box-shadow: 0 0 8px rgba(15, 49, 73, 0.3);
      }

      .control-group {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-top: 12px;
      }

      .control-group input {
        flex: 1;
        margin-left: 10px;
      }

      .control-group span {
        background: #0f3149; /* سرمه‌ای */
        color: #fff;
        padding: 10px 16px;
        border-radius: 6px;
        font-weight: bold;
        min-width: 60px;
        text-align: center;
        font-size: 14px;
      }

      button {
        width: 100%;
        padding: 12px;
        margin-top: 20px;
        border-radius: 8px;
        background: #0f3149; /* سرمه‌ای */
        color: white;
        border: none;
        font-weight: bold;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      button:hover {
        background: #0b253b; /* سرمه‌ای تیره‌تر */
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }

      /* ریسپانسیو */
      @media (max-width: 480px) {
        .table-box {
          width: 90%;
          margin: 100px auto 80px auto;
        }
        .table-body h3 {
          font-size: 20px;
        }
      }
    </style>
  </head>

  <body>
    <header></header>

    <div class="table-box">
      <div class="table-header">
        <!-- لوگوها -->
        <!-- <img src="عکس5.webp" alt="جهاد کشاورزی" />
        <img src="عکس4.png" alt="بانک کشاورزی" /> -->
      </div>
      <div class="table-body">
        <h3>ورود کاربر</h3>
        <input id="username" placeholder="نام کاربری" />
        <input id="password" type="password" placeholder="رمز عبور" />

        <div class="control-group">
          <input id="controlCode" placeholder="کد کنترلی را وارد کنید" />
          <span id="generatedCode">4567</span>
        </div>

        <button onclick="login()">ورود</button>
      </div>
    </div>

    <footer>© 2026 هاویرکشت</footer>

    <script>
      const API = "https://edu-api.havirkesht.ir";
const generatedCode = Math.floor(1000 + Math.random() * 9000);
      document.getElementById("generatedCode").textContent = generatedCode;

      function login() {
        if (!username.value || !password.value || !controlCode.value) {
          Swal.fire("خطا", "تمام فیلدها را وارد کنید", "warning");
          return;
        }

        if (controlCode.value !== String(generatedCode)) {
          Swal.fire("خطا", "کد کنترلی اشتباه است", "error");
          return;
        }

        const formData = new FormData();
        formData.append("username", username.value);
        formData.append("password", password.value);

        fetch(API + "/token", {
          method: "POST",
          body: formData,
        })
          .then((res) => {
            if (!res.ok) throw new Error("Login failed");
            return res.json();
          })
          .then((data) => {
            Swal.fire("موفق", "شما با موفقیت وارد شدید", "success");
            localStorage.setItem("token", data.access_token);
            setTimeout(() => location.href = "dashboard.html", 1000);
          })
          .catch((err) => {
            console.error(err);
            Swal.fire("خطا", "خطا در ورود", "error");
          });
      }
    </script>
  </body>
</html>

